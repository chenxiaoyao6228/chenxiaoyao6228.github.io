(window.webpackJsonp=window.webpackJsonp||[]).push([[98],{656:function(t,s,a){"use strict";a.r(s);var n=a(7),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"ÂâçË®Ä"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ÂâçË®Ä"}},[t._v("#")]),t._v(" ÂâçË®Ä")]),t._v(" "),a("p",[t._v("React fiber Êû∂ÊûÑ‰∏≠ÂºïÂÖ•‰∫Ü"),a("code",[t._v("‰ªªÂä°Ë∞ÉÂ∫¶")]),t._v("ÁöÑÊ¶ÇÂøµÂπ∂ÂÆûÁé∞‰∫Ü"),a("code",[t._v("scheduler")]),t._v("Ôºå‰ΩÜÊòØ‰ªªÂä°Ë∞ÉÂ∫¶ÊòØÊ°ÜÊû∂Êó†ÂÖ≥ÁöÑ\nÂæàÂ§öÊñáÁ´†ÂàÜÊûêÁöÑÊó∂ÂÄôÈÉΩ‰ºöÊê¨Êù•ËÆ°ÁÆóÊú∫‰∏≠Êìç‰ΩúÁ≥ªÁªüË∞ÉÂ∫¶ÔºåÂÖ∂‰ªñËØ≠Ë®Ä‰∏≠ÁöÑËøõÁ®ãÁÆ°ÁêÜÁ≠âÊ¶ÇÂøµÔºåÂØπ‰∫éÂâçÁ´ØÊù•ËØ¥Áü•ËØÜÂØÜÂ∫¶ÊØîËæÉÈ´ò‰∏çÊòìÁêÜËß£„ÄÇÂõ†Ê≠§Êú¨ÊñáÊâìÁÆó‰ªéÊ°à‰æãÂá∫ÂèëÁªìÂêà chrome performance Â∑•ÂÖ∑‰∏ÄÊ≠•Ê≠•ÂâñÊûê"),a("code",[t._v("‰ªªÂä°Ë∞ÉÂ∫¶")]),t._v("ÁöÑÂéüÁêÜ„ÄÇ")]),t._v(" "),a("p",[t._v("Êú¨ÊñáÂ∞ùËØïËß£Á≠î‰ª•‰∏ãÈóÆÈ¢òÔºö")]),t._v(" "),a("ul",[a("li",[t._v("ÊµèËßàÂô®ÁöÑÊ∏≤ÊüìÊµÅÁ®ã‰∏éÈïø‰ªªÂä°ÁöÑÂΩ±Âìç")]),t._v(" "),a("li",[t._v("‰∏∫‰ªÄ‰πàÈúÄË¶Å‰ªªÂä°Ë∞ÉÂ∫¶Ôºå‰∏é‰ªÄ‰πàÊòØÂêà‰Ωú‰ªªÂä°Ë∞ÉÂ∫¶")]),t._v(" "),a("li",[t._v("‰∏∫‰ªÄ‰πàÈúÄË¶Å‰ΩøÁî®ÂÆè‰ªªÂä°ËÄå‰∏çÊòØÂæÆ‰ªªÂä°ËøõË°åË∞ÉÂ∫¶")]),t._v(" "),a("li",[t._v("‰ΩøÁî® setTimeout Ë∞ÉÂ∫¶ÁöÑÈóÆÈ¢ò")]),t._v(" "),a("li",[t._v("message Channel ‰Ωú‰∏∫Ë∞ÉÂ∫¶ÊñπÊ°à")]),t._v(" "),a("li",[t._v("‰ªÄ‰πàÊòØ‰ªªÂä°ÂàáÁâáÔºü‰ªÄ‰πàÊòØÊó∂Èó¥ÂàáÁâá")])]),t._v(" "),a("h2",{attrs:{id:"ÂêåÊ≠•Èïø‰ªªÂä°Â†µÂ°ûÈ°µÈù¢Êõ¥Êñ∞"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ÂêåÊ≠•Èïø‰ªªÂä°Â†µÂ°ûÈ°µÈù¢Êõ¥Êñ∞"}},[t._v("#")]),t._v(" ÂêåÊ≠•Èïø‰ªªÂä°Â†µÂ°ûÈ°µÈù¢Êõ¥Êñ∞")]),t._v(" "),a("p",[t._v("Êàë‰ª¨Áü•ÈÅìÔºåÊµèËßàÂô®ÊòØ‰∏Ä‰∏™‰∏≠ÁöÑ JS Á∫øÁ®ãÂíå UI Ê∏≤ÊüìÁ∫øÁ®ãÊòØ‰∫íÊñ•ÁöÑ„ÄÇÈïøÊó∂Èó¥ÁöÑ JS ÂêåÊ≠•‰ªªÂä°‰ºöÈòªÂ°ûÊµèËßàÂô®Ê∏≤ÊüìÔºåÂØºËá¥È°µÈù¢Âç°È°ø(Âä®ÁîªÊâßË°åÂç°È°ø)ÁîöËá≥Â§±ÂéªÁõ∏Â∫î(Áî®Êà∑ËæìÂÖ•‰∏çÂìçÂ∫î).")]),t._v(" "),a("p",[t._v("ËøôÈáåÈÄöËøá‰∏Ä‰∏™ Demo ËøõË°åÊïàÊûúÊºîÁ§∫„ÄÇÂΩìÁÇπÂáª"),a("code",[t._v("ÁÇπÂáªÊ®°Êãü‰ªªÂä°")]),t._v("ÁöÑÊåâÈíÆÊó∂ÔºåÊàë‰ª¨ÊâßË°å‰∏ÄÊÆµ JS ‰ª£Á†ÅÔºåËøôÊÆµ‰ª£Á†Å‰ºöÂä®ÊÄÅÂàõÂª∫ 3000 ‰∏™‰ªªÂä°Âå∫ÊâßË°åÔºåÊØè‰∏™‰ªªÂä°ÁöÑÊâßË°åÊó∂Èó¥‰∏∫ 2msÔºå ÊÄª‰ΩìÁöÑ‰ªªÂä°Êó∂Èó¥‰∏∫ 6000ms(ÂèØËÉΩÊúâËØØÂ∑ÆÔºå‰ΩÜÊï¥‰Ωì‰∏çÂ§ß)")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ----------‰ªªÂä°ÂàõÂª∫----------")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("createWorks")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" taskDuration "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" works "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("work")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" startTime "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Date"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("now")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Date"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("now")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" startTime "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" taskDuration"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Ê®°Êãü‰ªªÂä°ÊâßË°åÊó∂Èó¥")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    works"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("work"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" works"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" works "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createWorks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//  -------Êõ¥Êñ∞È°µÈù¢------")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("flushWorks")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  works"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("work")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("work")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br")])]),a("p",[t._v("ÈÄöËøáËßÇÂØüÂèØ‰ª•ÂèëÁé∞ÔºåÂú®ÁÇπÂáª‰∫Ü button ‰πãÂêé JS ÊâßË°åÁöÑËøáÁ®ã‰∏≠ÔºåÊï¥‰∏™È°µÈù¢ÊòØÂ§Ñ‰∫é freeze Áä∂ÊÄÅÔºåËøôÂøÖÁÑ∂ÊòØÂæàÂΩ±ÂìçÁî®Êà∑‰ΩìÈ™åÁöÑ„ÄÇ")]),t._v(" "),a("p",[t._v("ÈÄöËøá Performance Èù¢ÊùøÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÔºåÊï¥‰∏™ JS ÁöÑ‰ªªÂä°ÊâßË°åÊó∂Èó¥ÈùûÂ∏∏ÈïøÔºåÂõ†Ê≠§Êàë‰ª¨ÂæóÊÉ≥ÂäûÊ≥ï‰ºòÂåñËøôÈÉ®ÂàÜÁöÑÈÄªËæë„ÄÇ")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/chenxiaoyao6228/cloudimg@main/2023/react-source-scheduler-long-task.png",alt:""}})]),t._v(" "),a("p",[t._v("üëâ "),a("a",{attrs:{href:"https://chenxiaoyao.cn/html-preview/?https://github.com/chenxiaoyao6228/fe-notes/blob/main/React%E6%BA%90%E7%A0%81/_demo/scheduler/2-sync-long-task.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Âú®Á∫øÊïàÊûúÈ¢ÑËßà"),a("OutboundLink")],1),t._v(", ÊàñËÄÖ‰∏ãËΩΩ"),a("RouterLink",{attrs:{to:"/docs/ReactÊ∫êÁ†Å/_demo/scheduler/1-long-sync-task.html"}},[t._v("Ê∫êÁ†Å")]),t._v("ÂêéÊâìÂºÄ("),a("strong",[t._v("‰∏∫ÈÅøÂÖçÊµèËßàÂô®Êèí‰ª∂ÂΩ±ÂìçÔºåËØ∑Âú®Êó†ÁóïÊ®°Âºè‰∏ãÊâìÂºÄ")]),t._v(")")],1),t._v(" "),a("h2",{attrs:{id:"settimeout-ÂºÇÊ≠•Êõ¥Êñ∞"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#settimeout-ÂºÇÊ≠•Êõ¥Êñ∞"}},[t._v("#")]),t._v(" setTimeout ÂºÇÊ≠•Êõ¥Êñ∞")]),t._v(" "),a("p",[t._v("Êó¢ÁÑ∂Êàë‰ª¨ÁöÑÂêåÊ≠•ÁöÑÈïø‰ªªÂä°‰∏çÂèØÊé•ÂèóÔºåÈÇ£‰πàÊàë‰ª¨Â∞±Ë¶ÅÊÉ≥ÂäûÊ≥ïÂ∞Ü‰ªªÂä°ÂèòÊàêÂèØ‰∏≠Êñ≠ÁöÑ„ÄÇÂêåÊó∂‰ΩøÁî®ÂÆè‰ªªÂä° API setTimeout ËøõË°åÂºÇÊ≠•Êõ¥Êñ∞(ÂΩìÁÑ∂Âú®ÂÆûÈôÖËøáÁ®ã‰∏≠Êàë‰ª¨Ë¶ÅËÄÉËôëÊõ¥Â§öÁöÑÂõ†Á¥†ÔºåÊØîÂ¶ÇÊâßË°å‰∏ä‰∏ãÊñáÁöÑ‰øùÂ≠ò‰ª•Âèä‰∏≠Êñ≠‰πãÂêéÁöÑÊÅ¢Â§ç, Â¶Ç React Fiber Êû∂ÊûÑ)")]),t._v(" "),a("blockquote",[a("p",[t._v("Ê≥®ÊÑèÊ≠§Â§Ñ‰∏çÂèØ‰ΩøÁî®ÂæÆ‰ªªÂä° API Â¶Ç "),a("code",[t._v("Promise")]),t._v("ÔºåÂõ†‰∏∫ÂæÆ‰ªªÂä°‰ºöÂú®‰∏Ä‰∏™ÂÆè‰ªªÂä°ÊâßË°åÂÆåÊàê‰πãÂêéÂÖ®ÈÉ®ÊâßË°åÔºåÂÆûÈôÖÊïàÊûúÂ∞±ÂíåÂêåÊ≠•ÊâßË°åÂ∑Æ‰∏çÂ§ö‰∫ÜÔºåÂÖ≥‰∫é"),a("RouterLink",{attrs:{to:"/docs/Javascript/ÊµèËßàÂô®ÁöÑ‰∫ã‰ª∂Âæ™ÁéØÊú∫Âà∂.html"}},[t._v("ÂÆè‰ªªÂä°ÂæÆ‰ªªÂä°ÁöÑÁõ∏ÂÖ≥Áü•ËØÜÁÇπÂèØ‰ª•ÁúãËøôÈáåÁöÑ‰ªãÁªç")])],1)]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// --------‰ªªÂä°Ë∞ÉÂ∫¶--------")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("workLoop")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" work "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" works"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("shift")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("work"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("work")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("workLoop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateView")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Date"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("now")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" startTime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("flushWorks")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("workLoop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br")])]),a("p",[t._v("ÁÇπÂáªÊåâÈíÆËßÇÂØüÈ°µÈù¢ÂèØ‰ª•ÂèëÁé∞ÔºåÁªèËøá setTimeout ËøõË°åÂºÇÊ≠•Êõ¥Êñ∞ÂêéÔºåÁé∞Âú®‰ªªÂä°ÊâßË°åÁöÑÊó∂ÂÄôÂ∑≤Áªè‰∏ç‰ºöÈòªÂ°ûÈ°µÈù¢Âä®ÁîªÊ∏≤Êüì‰∫Ü„ÄÇ‰ΩÜÊòØËøôÈáåÂ≠òÂú®‰∏Ä‰∏™ÈóÆÈ¢òÂ∞±ÊòØ setTimeout ÁöÑË∞ÉÂ∫¶Êó∂Êú∫ÈóÆÈ¢òÔºåËôΩÁÑ∂Êàë‰ª¨Âú®‰ª£Á†ÅÈáåÈù¢ÂÜô‰∫Ü"),a("code",[t._v("setTimeout(workLoop, 0)")]),t._v(", ‰ΩÜÊòØÂÆûÈôÖ‰∏äÊµèËßàÂô®ÊØèÊ¨°Ë∞ÉÂ∫¶ÁöÑÊó∂ÂÄôÁöÑÈÉΩ‰ºöÊúâ‰∏Ä‰∏™ 4ms ÁöÑÂª∂ËøüÔºå‰ªéÂõæ‰∏≠Êàë‰ª¨ÂèØ‰ª•ÁúãÂá∫Âú®‰∏ÄÂ∏ßÁöÑÊó∂Èó¥ÂÜÖ‰ªÖÊâßË°å‰∫Ü 3 ‰∏™‰ªªÂä°ÔºåËøô‰πüÂØºËá¥‰∫ÜÊÄª‰ªªÂä°ÊâßË°åÊó∂ÈïøÂèò‰∏∫‰∫Ü 18sÔºåÈÇ£‰πàÊúâÊ≤°Êúâ‰ªÄ‰πàÂäûÊ≥ïÂèØ‰ª•ÊèêÈ´òË∞ÉÂ∫¶ÁöÑÈ¢ëÁéáÂë¢Ôºü")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/chenxiaoyao6228/cloudimg@main/2023/react-source-scheduler-setTimeout.png",alt:""}})]),t._v(" "),a("p",[t._v("üëâ "),a("a",{attrs:{href:"https://chenxiaoyao6228.github.io/html-preview/?https://github.com/chenxiaoyao6228/fe-notes/blob/main/React%E6%BA%90%E7%A0%81/_demo/scheduler/3-asyn-setTimeout.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Âú®Á∫øÊïàÊûúÈ¢ÑËßà"),a("OutboundLink")],1),t._v(", ÊàñËÄÖ‰∏ãËΩΩ"),a("RouterLink",{attrs:{to:"/docs/ReactÊ∫êÁ†Å/_demo/scheduler/3-asyn-setTimeout.html"}},[t._v("Ê∫êÁ†Å")]),t._v("ÂêéÊâìÂºÄ")],1),t._v(" "),a("h2",{attrs:{id:"messagechannel-ÂºÇÊ≠•Êõ¥Êñ∞"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#messagechannel-ÂºÇÊ≠•Êõ¥Êñ∞"}},[t._v("#")]),t._v(" messageChannel ÂºÇÊ≠•Êõ¥Êñ∞")]),t._v(" "),a("p",[t._v("‰∏äÈù¢ÊèêÂà∞‰∫ÜÊàë‰ª¨ÈúÄË¶ÅÊèêÈ´òÊµèËßàÂô®ÁöÑË∞ÉÂ∫¶È¢ëÁéáÔºåËøôÈáåÊàë‰ª¨‰ΩøÁî® messageChannel Êù•ÂÆûÁé∞ÂØπÂ∫îÁöÑÂäüËÉΩ„ÄÇÂÆûÈôÖ‰∏äÂ¶ÇÊûúÊàë‰ª¨‰∏çËÄÉËôë‰ªªÂä°ÊâßË°åÁöÑÊó∂Èó¥, ÂçïÁ∫ØÊµãËØï messageChannel ÁöÑË∞ÉÁî®Ê¨°Êï∞ÁöÑËØùÔºåÂÖ∂Ë°®Áé∞ÊïàÊûúËøòÊòØÂæà‰∫ÆÁúºÁöÑÔºå1s ÂÜÖÁöÑË∞ÉÁî®Ê¨°Êï∞ÂèØ‰ª•ËææÂà∞ 16 ‰∏áÊ¨°(ÂèñÂÜ≥‰∫éÊú∫Âô®ÁöÑÊÄßËÉΩ„ÄÇ)")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/chenxiaoyao6228/cloudimg@main/2023/react-source-scheduler-message-channel-performance.png",alt:""}})]),t._v(" "),a("p",[t._v("üëâ "),a("a",{attrs:{href:"https://chenxiaoyao6228.github.io/html-preview/?https://github.com/chenxiaoyao6228/fe-notes/blob/main/React%E6%BA%90%E7%A0%81/_demo/scheduler/5-message-channel-performance.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Âú®Á∫øÊïàÊûúÈ¢ÑËßà"),a("OutboundLink")],1),t._v(", ÊàñËÄÖ‰∏ãËΩΩ"),a("RouterLink",{attrs:{to:"/docs/ReactÊ∫êÁ†Å/_demo/scheduler/5-message-channel-performance.html"}},[t._v("Ê∫êÁ†Å")]),t._v("ÂêéÊâìÂºÄ")],1),t._v(" "),a("p",[t._v("Êúâ‰∫Ü‰∏äÈù¢ÁöÑÊï∞ÊçÆÔºåÊàë‰ª¨‰ΩøÁî® messageChannel Êù•ÊîπÈÄ†Êàë‰ª¨ÁöÑÁ§∫‰æãÔºåËøôÈáå‰∏∫‰∫ÜÊñπ‰æø‰∏çÁÜüÊÇâ messageChannel ÁöÑÊúãÂèãÁêÜËß£ÔºåÊàë‰ª¨Ê®°Êãü setTimeout ÁöÑ‰ΩøÁî®ÊñπÂºèÊù•‰ΩøÁî® messageChannel ËøõË°å‰ªªÂä°Ë∞ÉÂ∫¶ÔºåÂÖ∂‰Ωô‰ª£Á†Å‰øùÊåÅ‰∏çÂèò„ÄÇ")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" _setTimeout "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("workLoop")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" channel "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("onMessageCb")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("channel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      channel "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MessageChannel")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      channel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("port1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("onmessage "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" onMessageCb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    channel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("port2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("postMessage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("workLoop")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" work "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" works"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("shift")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("work"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("work")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("_setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("workLoop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateView")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Date"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("now")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" startTime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br")])]),a("p",[t._v("ÈÄöËøá Performance Èù¢ÊùøÂèØ‰ª•ÂèëÁé∞ÔºåÂú®ÊØè‰∏™‰ªªÂä°ÊâßË°åÊó∂Èó¥‰∏∫ 2ms ÁöÑÊÉÖÂÜµ‰∏ãÔºå‰∏ÄÂ∏ßÂÜÖÂèØ‰ª•ÊâßË°åÁöÑ‰ªªÂä°Êï∞‰∏∫ 8„ÄÇ‰ΩÜÂç≥‰æøÂ¶ÇÊ≠§Ôºå‰æùÁÑ∂Â≠òÂú®‰∏ÄÂÆöÁöÑË∞ÉÂ∫¶ËÄóÊó∂„ÄÇ")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/chenxiaoyao6228/cloudimg@main/2023/react-source-scheduler-message-channel.png",alt:""}})]),t._v(" "),a("p",[t._v("üëâ "),a("a",{attrs:{href:"https://chenxiaoyao6228.github.io/html-preview/?https://github.com/chenxiaoyao6228/fe-notes/blob/main/React%E6%BA%90%E7%A0%81/_demo/scheduler/4-async-message-channel.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Âú®Á∫øÊïàÊûúÈ¢ÑËßà"),a("OutboundLink")],1),t._v(", ÊàñËÄÖ‰∏ãËΩΩ"),a("RouterLink",{attrs:{to:"/docs/ReactÊ∫êÁ†Å/_demo/scheduler/4-async-message-channel.html"}},[t._v("Ê∫êÁ†Å")]),t._v("ÂêéÊâìÂºÄ")],1),t._v(" "),a("h2",{attrs:{id:"‰ªªÂä°ÂàáÁâá"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#‰ªªÂä°ÂàáÁâá"}},[t._v("#")]),t._v(" ‰ªªÂä°ÂàáÁâá")]),t._v(" "),a("p",[t._v("Âú®‰∏äÈù¢ÁöÑÂü∫Á°Ä‰∏äÔºåÊàë‰ª¨ÂæàÂÆπÊòìÊúâËøôÊ†∑ÁöÑÊÉ≥Ê≥ïÔºö‚ÄúÂ∞ΩÈáèÂáèÂ∞ë‰ªªÂä°Ë∞ÉÂ∫¶ÁöÑÊ¨°Êï∞‚Äù‰∏çÂ∞±ÂèØ‰ª•‰∫ÜÂêóÔºüÊàë‰ª¨ÂèØ‰ª•ÊîπÈÄ†‰∏ã workLoop ÂáΩÊï∞ÔºåËÆ©Â∞ΩÂèØËÉΩÂ§öÁöÑ‰ªªÂä°Âú®‰∏ÄÂ∏ßÂÜÖÊâßË°å„ÄÇ")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("workLoop")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" workExecutedCount "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("workExecutedCount "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" work "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" works"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("shift")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("work"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("work")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      workExecutedCount"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateView")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Date"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("now")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" startTime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("works"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("_setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("workLoop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br")])]),a("p",[t._v("ÈÄöËøá Performance Èù¢ÊùøÂèØ‰ª•ÁúãÂà∞ÔºåÊÄßËÉΩÁï•ÂæÆÊúâÊèêÂçá„ÄÇ\n"),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/chenxiaoyao6228/cloudimg@main/2023/react-source-scheduler-task-slicing.png",alt:""}})]),t._v(" "),a("h2",{attrs:{id:"Êó∂Èó¥ÂàáÁâá"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#Êó∂Èó¥ÂàáÁâá"}},[t._v("#")]),t._v(" Êó∂Èó¥ÂàáÁâá")]),t._v(" "),a("p",[t._v("‰∏äËø∞ÁöÑ‚Äú‰ªªÂä°ÂàáÁâá‚ÄùÊñπÊ°àÊòØÂü∫‰∫éÊàë‰ª¨Â∑≤Áü•Âçï‰∏™‰ªªÂä°ÊâßË°åÊó∂Èó¥ÁöÑÂâçÊèê‰∏ãÔºå‰ΩÜÊòØÂú®ÂÆûÈôÖ‰∏öÂä°‰∏≠ÊØè‰∏™‰ªªÂä°ÁöÑÊâßË°åÊó∂Èó¥ÊòØ‰∏çÁ°ÆÂÆöÁöÑ„ÄÇÂõ†Ê≠§Êàë‰ª¨ÂèØËÉΩ‰ºöÊÉ≥Âà∞Âè¶Â§ñ‰∏ÄÁßçÂàáÁâáÁöÑÊñπÂºèÔºö‚ÄúÊó∂Èó¥ÂàáÁâá‚Äù„ÄÇ ÁªôÂÆö‰∏Ä‰∏™È¢ÑÂÆöÁöÑÊó∂Èó¥ÊØîÂ¶Ç 5ms, ÊØèÊ¨°‰ªªÂä°ÊâßË°åÂÆåÊàê‰πãÂêéÈÉΩ‰ºöÂéªÂà§Êñ≠‰∏Ä‰∏ãÊòØÂê¶Ë∂ÖÂá∫‰∫ÜÊó∂Èó¥ÂàÜÁâáÁöÑÈôêÂà∂ÔºåÂ¶ÇÊûúÊòØÁöÑËØùÂ∞±ËÆ©Âá∫ÊâßË°åÊùÉ‰∫§ÁªôÊµèËßàÂô®ÂéªÊ∏≤Êüì„ÄÇ")]),t._v(" "),a("p",[t._v("ËøôÈáåÊàë‰ª¨Êù•ÊîπÈÄ†‰∏ã createWorks ÊñπÊ≥ïÔºåÊØèÊ¨°ÁîüÊàê‰∏Ä‰∏™Âú® 0-1 ÊØ´Áßí‰πãÂÜÖÁöÑ‰ªªÂä°ÔºåÁÑ∂ÂêéÊâßË°åÔºåÊü•ÁúãÊïàÊûú„ÄÇ")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("createWorks")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" taskDuration "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Math"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("random")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ÈöèÊú∫ÁîüÊàê 0-1")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" works "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    works"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" start "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" performance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("now")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" time "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Math"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("random")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("performance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("now")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" start "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" time"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" works"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" works "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createWorks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br")])]),a("p",[t._v("ÂØπÂ∫îÁöÑÊïàÊûúÂ¶Ç‰∏ãÔºö\n"),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/chenxiaoyao6228/cloudimg@main/2023/react-source-scheduler-time-slicing.png",alt:""}})]),t._v(" "),a("p",[t._v("üëâ "),a("a",{attrs:{href:"https://chenxiaoyao6228.github.io/html-preview/?https://github.com/chenxiaoyao6228/fe-notes/blob/main/React%E6%BA%90%E7%A0%81/_demo/scheduler/7-async-time-slicing.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Âú®Á∫øÊïàÊûúÈ¢ÑËßà"),a("OutboundLink")],1),t._v(", ÊàñËÄÖ‰∏ãËΩΩ"),a("RouterLink",{attrs:{to:"/docs/ReactÊ∫êÁ†Å/_demo/scheduler/7-async-time-slicing.html"}},[t._v("Ê∫êÁ†Å")]),t._v("ÂêéÊâìÂºÄ")],1),t._v(" "),a("p",[t._v("Ëá≥Ê≠§ÔºåÊàë‰ª¨Â∑≤ÁªèÂàùÊ≠•‰∫ÜËß£‰∫ÜË∞ÉÂ∫¶Áõ∏ÂÖ≥ÁöÑÁü•ËØÜÔºå‰∏ã‰∏ÄÁØá‰ºöËÆ≤ËÆ≤‰ºòÂÖàÁ∫ßË∞ÉÂ∫¶Áõ∏ÂÖ≥ÁöÑ‰∏úË•ø„ÄÇ")])])}),[],!1,null,null,null);s.default=e.exports}}]);