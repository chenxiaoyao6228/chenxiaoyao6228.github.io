(window.webpackJsonp=window.webpackJsonp||[]).push([[150],{708:function(t,v,a){"use strict";a.r(v);var _=a(7),s=Object(_.a)({},(function(){var t=this,v=t.$createElement,a=t._self._c||v;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[t._v("#")]),t._v(" 前言")]),t._v(" "),a("p",[t._v("当浏览器解析 DOM时候，遇到 script 标签时，会暂停 DOM 的解析，先加载并执行 script 中的代码，然后再继续 DOM 的解析。这样会导致页面的加载和渲染被阻塞，影响用户体验。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/chenxiaoyao6228/cloudimg@main/2023/async-defer-1.png",alt:""}})]),t._v(" "),a("p",[t._v("async 和 defer 是用于在 HTML 中加载外部 JavaScript 脚本的两个属性，它们可以帮助优化页面加载和脚本执行的顺序，从而提高页面的性能。")]),t._v(" "),a("h2",{attrs:{id:"defer"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#defer"}},[t._v("#")]),t._v(" defer")]),t._v(" "),a("p",[t._v("defer 是 HTML 解析完才会执行。如果是多个，按照"),a("strong",[t._v("加载的顺序")]),t._v("依次执行。"),a("strong",[t._v("defer 脚本会在 DOMContentLoaded 和 load 事件之前执行")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/chenxiaoyao6228/cloudimg@main/2023/async-defer-2.png",alt:""}})]),t._v(" "),a("p",[t._v("当脚本依赖其他脚本或需要在 DOM 解析后执行时，可以考虑使用 defer 属性.")]),t._v(" "),a("p",[t._v("一些使用场景：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("DOM 操作： 如果你的脚本需要操作页面的 DOM 元素，确保它在页面完全解析后再执行。这样可以避免在脚本执行时尝试访问尚未加载的 DOM 元素。")])]),t._v(" "),a("li",[a("p",[t._v("依赖其他脚本： 如果你的脚本依赖于其他已加载的脚本，为了确保"),a("strong",[t._v("正确的执行顺序")]),t._v("，可以使用 defer。这样可以避免在依赖脚本未加载完成时尝试执行。")])]),t._v(" "),a("li",[a("p",[t._v("初始化代码： 如果你的脚本负责初始化应用程序或页面的某些功能，最好在 DOM 解析完成后再运行。这可以确保你的脚本在正确的上下文中执行，以免因为未完全加载的 DOM 而出现问题。")])])]),t._v(" "),a("h2",{attrs:{id:"async"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#async"}},[t._v("#")]),t._v(" async")]),t._v(" "),a("p",[t._v("async 会在脚本加载完之后立即执行。如果是多个，执行顺序和加载顺序无关。async 会在 load 事件之前执行，但并不能确保与 DOMContentLoaded 的执行先后顺序。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/chenxiaoyao6228/cloudimg@main/2023/async-defer-3.png",alt:""}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/chenxiaoyao6228/cloudimg@main/2023/async-defer-4.png",alt:""}})]),t._v(" "),a("p",[t._v("当脚本不依赖其他脚本且不需要等待 DOM 解析时，可以考虑使用 async 属性.")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("分析或追踪代码： 如果你有一些用于分析用户行为或追踪页面性能的代码，这些代码通常不会直接操作 DOM，而是在页面加载时发送数据到服务器。这样的代码不会受到等待 DOM 解析的限制，可以使用 async 加载")])]),t._v(" "),a("li",[a("p",[t._v("独立组件： 如果你编写的 JavaScript 脚本是独立的组件，不依赖于其他脚本或 DOM 解析，可以使用 async。例如，一些独立的小部件或插件，它们可能只需要自己的逻辑而不涉及整个页面的结构")])]),t._v(" "),a("li",[a("p",[t._v("异步加载内容： 如果你希望在页面加载完成后异步加载一些内容（例如通过 AJAX 或 Fetch 请求），这些请求的响应不会影响页面的初始渲染，可以使用 async")])])]),t._v(" "),a("h2",{attrs:{id:"script"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#script"}},[t._v("#")]),t._v(" script")]),t._v(" "),a("p",[t._v("不是所有的script都需要加上defer或者async属性，需要根据实际情况来决定是否使用。")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("内联脚本： 如果你的脚本很小并且是内联的（即直接在 HTML 文件中嵌入），则它们会在解析到script 标签时立即执行，不需要考虑 async 或 defer")])]),t._v(" "),a("li",[a("p",[t._v("不涉及 DOM 操作的脚本： 如果你的脚本只是进行一些计算或逻辑处理，与页面的 DOM 结构无关，那么加载顺序可能不是关键，你可以根据需要决定是否使用 async 或 defer。")])]),t._v(" "),a("li",[a("p",[t._v("脚本加载顺序无关紧要的情况： 如果脚本之间的加载顺序对页面的功能没有太大影响，也可以根据需要灵活选择是否使用 async 或 defer。")])]),t._v(" "),a("li",[a("p",[t._v("独立的脚本： 如果你的脚本是独立的，不依赖于其他脚本，而且也不需要等待 DOM 解析完成，可以考虑使用 async，或者将脚本放在页面的末尾，不使用 async 或 defer")])])]),t._v(" "),a("h2",{attrs:{id:"总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("类型")]),t._v(" "),a("th",[t._v("执行顺序")]),t._v(" "),a("th",[t._v("是否阻塞执行")]),t._v(" "),a("th",[t._v("适用场景")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("script")]),t._v(" "),a("td",[t._v("在 HTML 中的顺序")]),t._v(" "),a("td",[t._v("是")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[t._v("script defer")]),t._v(" "),a("td",[t._v("在 HTML 中的顺序")]),t._v(" "),a("td",[t._v("否")]),t._v(" "),a("td",[t._v("依赖其他脚本/DOM 操作")])]),t._v(" "),a("tr",[a("td",[t._v("script async")]),t._v(" "),a("td",[t._v("网络加载的顺序")]),t._v(" "),a("td",[t._v("否")]),t._v(" "),a("td",[t._v("三方工具/独立组件/异步加载内容")])])])])])}),[],!1,null,null,null);v.default=s.exports}}]);